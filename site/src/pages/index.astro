---
import BaseLayout from '../layouts/BaseLayout.astro';
import PageHeader from '../components/PageHeader.astro';
import KeyMetrics from '../components/KeyMetrics.astro';
import AudienceNav from '../components/AudienceNav.astro';
import WarningBox from '../components/WarningBox.astro';
import LinkButton from '../components/LinkButton.astro';
import BlogPostCard from '../components/BlogPostCard.astro';
import { getCollection } from 'astro:content';

const recentPosts = (await getCollection('blog'))
  .filter((post) => !post.data.draft)
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())
  .slice(0, 3);
---

<BaseLayout title="Failure-First Embodied AI | Research Framework">
  <PageHeader
    title="Failure-First Embodied AI"
    tagline="Studying how AI systems fail to build better defenses"
  />

  <!-- Value Proposition -->
  <section class="hero-section">
    <div class="hero-content">
      <p class="hero-lead">
        Traditional AI safety measures task success. We measure
        <strong>failure patterns</strong>, <strong>degradation modes</strong>, and
        <strong>recovery mechanisms</strong>.
      </p>
      <p>
        Through adversarial testing across 102+ models and 19,000+ prompts, we identify
        how AI systems break down under pressure, how failures cascade, and what makes
        recovery possible.
      </p>
    </div>
  </section>

  <!-- Key Metrics Dashboard -->
  <KeyMetrics />

  <!-- Audience Entry Points -->
  <section>
    <h2>Start Here</h2>
    <p>Choose your path based on what you need:</p>
    <AudienceNav />
  </section>

  <!-- Core Research Areas -->
  <section>
    <h2>Core Research</h2>
    <div class="research-areas">
      <a href="/research/moltbook/" class="research-area card">
        <div class="research-area-header">
          <span class="area-icon" aria-hidden="true">&#x2B19;</span>
          <h3>Multi-Agent Attack Surface</h3>
        </div>
        <p>
          Analysis of 1,497 AI agent interactions on Moltbook, an agent-only social network.
          Discovered environment shaping and narrative erosion as dominant attack vectors.
        </p>
        <span class="area-tag">Active Research</span>
      </a>

      <a href="/research/model-vulnerability/" class="research-area card">
        <div class="research-area-header">
          <span class="area-icon" aria-hidden="true">&#x2B21;</span>
          <h3>Model Vulnerability Patterns</h3>
        </div>
        <p>
          How model size, architecture, and training affect adversarial robustness.
          U-shaped safety curves reveal capability without safety increases risk.
        </p>
        <span class="area-tag">Key Finding</span>
      </a>

      <a href="/research/attack-taxonomy/" class="research-area card">
        <div class="research-area-header">
          <span class="area-icon" aria-hidden="true">&#x25CE;</span>
          <h3>Attack Pattern Taxonomy</h3>
        </div>
        <p>
          34+ attack patterns classified across 7 categories. From constraint shadowing
          to temporal authority mirages.
        </p>
        <span class="area-tag">Reference</span>
      </a>

      <a href="/research/defense-patterns/" class="research-area card">
        <div class="research-area-header">
          <span class="area-icon" aria-hidden="true">&#x2B22;</span>
          <h3>Defense Patterns</h3>
        </div>
        <p>
          How models resist adversarial attacks. The format/content separation pattern
          and other defensive mechanisms.
        </p>
        <span class="area-tag">Analysis</span>
      </a>
    </div>
    <p style="margin-top: 1.5rem; text-align: center;">
      <a href="/research/" class="link-button">All Research Studies &rarr;</a>
    </p>
  </section>

  <WarningBox>
    <p>
      This is <strong>defensive AI safety research</strong>. All adversarial content is
      pattern-level description for testing, not operational instructions for exploitation.
      Similar to penetration testing in cybersecurity: we study vulnerabilities to build better defenses.
    </p>
  </WarningBox>

  <!-- Philosophy Callout -->
  <section class="philosophy-callout">
    <h2>The Failure-First Philosophy</h2>
    <blockquote>
      "Failure is not an edge case. It's the primary object of study."
    </blockquote>
    <p>
      Most AI safety work optimizes for capability and treats failure as an afterthought.
      We invert this: by understanding how systems fail, we can design better safeguards,
      recovery mechanisms, and human-in-the-loop interventions.
    </p>
    <p style="margin-top: 1rem;">
      <a href="/manifesto/" class="link-button">Read the Manifesto</a>
    </p>
  </section>

  <!-- Recent Blog Posts -->
  {recentPosts.length > 0 && (
    <section>
      <h2>Latest from the Blog</h2>
      <div class="blog-preview">
        {recentPosts.map((post) => (
          <BlogPostCard
            title={post.data.title}
            description={post.data.description}
            date={post.data.date}
            href={`/blog/${post.id}/`}
            tags={post.data.tags}
          />
        ))}
      </div>
      <p style="margin-top: 1.5rem;">
        <a href="/blog/" class="link-button" style="font-size: 0.875rem;">All posts &rarr;</a>
      </p>
    </section>
  )}

  <!-- Quick Start -->
  <section>
    <h2>Quick Start</h2>
    <p>Clone the repository and validate datasets:</p>
    <pre><code>git clone https://github.com/adrianwedd/failure-first.git
cd failure-first
pip install -r requirements-dev.txt
make validate  # Schema validation
make lint      # Safety checks</code></pre>
    <div class="links" style="margin-top: 1.5rem;">
      <LinkButton href="https://github.com/adrianwedd/failure-first" text="View on GitHub" external />
      <LinkButton href="/framework/" text="Framework Guide" />
    </div>
  </section>
</BaseLayout>

<style>
  .hero-section {
    margin-bottom: 0;
  }

  .hero-content {
    max-width: 720px;
  }

  .hero-lead {
    font-size: 1.25rem;
    color: var(--fg);
    line-height: 1.5;
    margin-bottom: 1rem;
  }

  .research-areas {
    display: grid;
    grid-template-columns: repeat(2, 1fr);
    gap: 1rem;
    margin-top: 1.5rem;
  }

  .research-area {
    display: flex;
    flex-direction: column;
    text-decoration: none;
    border-bottom: none;
  }

  .research-area:hover {
    border-bottom: none;
  }

  .research-area-header {
    display: flex;
    align-items: center;
    gap: 0.75rem;
    margin-bottom: 0.5rem;
  }

  .area-icon {
    font-size: 1.25rem;
    color: var(--accent-primary);
    opacity: 0.8;
  }

  .research-area h3 {
    margin: 0;
    font-size: 1rem;
  }

  .research-area p {
    font-size: 0.875rem;
    color: var(--fg-dim);
    flex-grow: 1;
    margin-bottom: 0.75rem;
  }

  .area-tag {
    font-family: 'JetBrains Mono', monospace;
    font-size: 0.625rem;
    color: var(--accent-primary);
    text-transform: uppercase;
    letter-spacing: 0.04em;
    opacity: 0.7;
  }

  .philosophy-callout {
    background: var(--bg-card);
    border: 1px solid var(--border);
    border-radius: 4px;
    padding: 2rem;
    margin: 3rem 0;
    text-align: center;
  }

  .philosophy-callout h2 {
    margin-top: 0;
  }

  .philosophy-callout blockquote {
    font-size: 1.25rem;
    font-style: italic;
    color: var(--accent-primary);
    margin: 1.5rem 0;
    padding: 0;
    border: none;
  }

  .philosophy-callout p {
    max-width: 600px;
    margin-left: auto;
    margin-right: auto;
  }

  @media (max-width: 768px) {
    .research-areas {
      grid-template-columns: 1fr;
    }

    .philosophy-callout {
      padding: 1.5rem;
    }
  }
</style>
